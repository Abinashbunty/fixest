<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Finds observations to be removed from ML estimation with factors/clusters — obs2remove • fixest</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Finds observations to be removed from ML estimation with factors/clusters — obs2remove" />
<meta property="og:description" content="For Poisson, Negative Binomial or Logit estimations with fixed-effects, when the dependent variable is only equal to 0 (or 1 for Logit) for one cluster value this leads to a perfect fit for that cluster value by setting its associated cluster coefficient to -Inf. Thus these observations need to be removed before estimation. This function gives the observations to be removed. Note that by default the function femlm or feglm drops them before performing the estimation." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fixest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fixest_walkthrough.html">Fast Fixed-Effects Estimation: Short introduction</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Finds observations to be removed from ML estimation with factors/clusters</h1>
    
    <div class="hidden name"><code>obs2remove.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For Poisson, Negative Binomial or Logit estimations with fixed-effects, when the dependent variable is only equal to 0 (or 1 for Logit) for one cluster value this leads to a perfect fit for that cluster value by setting its associated cluster coefficient to <code>-Inf</code>. Thus these observations need to be removed before estimation. This function gives the observations to be removed. Note that by default the function <code><a href='femlm.html'>femlm</a></code> or <code><a href='feglm.html'>feglm</a></code> drops them before performing the estimation.</p>
    </div>

    <pre class="usage"><span class='fu'>obs2remove</span>(<span class='no'>fml</span>, <span class='no'>data</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"poisson"</span>, <span class='st'>"negbin"</span>, <span class='st'>"logit"</span>))</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fml</th>
      <td><p>A formula containing the dependent variable and the clusters. It can be of the type: <code>y ~ cluster_1 + cluster_2</code> or <code>y ~ x1 | cluster_1 + cluster_1</code> (in which case variables before the pipe are ignored).</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data.frame containing the variables in the formula.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Character scalar: either &#8220;poisson&#8221; (default), &#8220;negbin&#8221; or &#8220;logit&#8221;.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>It returns an integer vector of observations to be removed. If no observations are to be removed, an empty integer vector is returned. In both cases, it is of class <code>fixest.obs2remove</code>.
The vector has an attribute <code>cluster</code> which is a list giving the IDs of the clusters that have been removed, for each cluster dimension.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>base</span> <span class='kw'>=</span> <span class='no'>iris</span>
<span class='co'># v6: Petal.Length with only 0 values for 'setosa'</span>
<span class='no'>base</span>$<span class='no'>v6</span> <span class='kw'>=</span> <span class='no'>base</span>$<span class='no'>Petal.Length</span>
<span class='no'>base</span>$<span class='no'>v6</span>[<span class='no'>base</span>$<span class='no'>Species</span> <span class='kw'>==</span> <span class='st'>"setosa"</span>] <span class='kw'>=</span> <span class='fl'>0</span>

(<span class='no'>x</span> <span class='kw'>=</span> <span class='fu'>obs2remove</span>(<span class='no'>v6</span> ~ <span class='no'>Species</span>, <span class='no'>base</span>))</div><div class='output co'>#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
#&gt; [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
#&gt; attr(,"class")
#&gt; [1] "fixest.obs2remove"
#&gt; attr(,"family")
#&gt; [1] "poisson"
#&gt; attr(,"cluster")
#&gt; attr(,"cluster")$Species
#&gt; [1] "setosa"
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span>(<span class='no'>x</span>, <span class='st'>"cluster"</span>)</div><div class='output co'>#&gt; $Species
#&gt; [1] "setosa"
#&gt; </div><div class='input'>
<span class='co'># The two results are identical:</span>
<span class='no'>res_1</span> <span class='kw'>=</span> <span class='fu'><a href='femlm.html'>femlm</a></span>(<span class='no'>v6</span> ~ <span class='no'>Petal.Width</span> <span class='kw'>|</span> <span class='no'>Species</span>, <span class='no'>base</span>)</div><div class='output co'>#&gt; <span class='message'>NOTE: 1 fixed-effect (50 observations) removed because of only zero outcomes.</span></div><div class='input'><span class='co'># =&gt; note + obsRemoved is created</span>

<span class='no'>res_2</span> <span class='kw'>=</span> <span class='fu'><a href='femlm.html'>femlm</a></span>(<span class='no'>v6</span> ~ <span class='no'>Petal.Width</span> <span class='kw'>|</span> <span class='no'>Species</span>, <span class='no'>base</span>[-<span class='no'>x</span>, ])
<span class='co'># =&gt; no note because observations are removed before</span>

<span class='fu'><a href='etable.html'>esttable</a></span>(<span class='no'>res_1</span>, <span class='no'>res_2</span>)</div><div class='output co'>#&gt;                               res_1           res_2
#&gt; Petal.Width         0.2089 (0.1318) 0.2089 (0.1318)
#&gt; Fixed-Effects:      --------------- ---------------
#&gt; Species                         Yes             Yes
#&gt; ___________________ _______________ _______________
#&gt; Observations                    100             100
#&gt; S.E. type            1-way: Species  1-way: Species
#&gt; Squared Corr.                 0.699           0.699
#&gt; Pseudo R2                   0.02726         0.02726
#&gt; BIC                          376.54          376.54</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span>(<span class='no'>res_1</span>$<span class='no'>obsRemoved</span> <span class='kw'>==</span> <span class='no'>x</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Laurent Berge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


